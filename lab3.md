# การทดลองที่ 3 เรื่อง การเขียนโปรแกรมเอ้าพุทสัญญาณดิจิทัล
## วัตถุประสงค์
1. เพื่อศึกษาการนำmicrocontrollerที่เขียนโปรแกรมแล้วนำไปประยุกต์ใช้
2. เพื่อศึกษาเกี่ยวกับการ run microcontroller
## อุปกรณ์ที่ใช้
1.คอมพิวเตอร์
2.microcontroller ESP01
3. อุปกรณ์ต่อ USB-Serial
4. อแดปเตอร์ที่ต่อสายพอร์ท 0 กับ 1
5. รีเรย์
6. ตัวโปรแกรมเอ้าพุตสัญญาณ
7. ขั้วชาร์ต
## ศึกษาข้อมูลเบื้องต้น
1. run relay https://www.youtube.com/watch?v=6JnhaUILGuw
2. รีเรย์ http://www.psptech.co.th/
03_Output-Port https://github.com/choompol-boonmee/lab63b/blob/master/examples/03_Output-Port/src/main.cpp
## วิธีทำการทดลอง
1. เชื่อมต่อ อแดปเตอร์ เข้ากับคอมพิวเตอร์ด้วยการต่อ USB ไปยัง Serial
2. นำ microcontroller เชื่อมต่อกับพอร์ท
3. เปิด cmd ใช้คำสั่ง cd pattani
4. ใช้คำสั่ง cd 03_Output-Port ตามด้วยคำสั่ง 1s และคำสั่ง pwd
5. ใช้คำสั่ง vi src/main.cpp จะขึ้นโค้ดดังนี้
![alt text](https://cdn.discordapp.com/attachments/823124660014940180/824293373791174778/Screenshot_2021-03-24_214700.jpg)
โค้ดของโปรแกรมนี้เซตที่พอร์ท 0 คือ พอร์ทเอ้าพุต และมีคำสั่งวนลูปทุกๆ 500 ms โดยจะนับ cnt ไปเรื่อยๆโดยที่เมือ cnt เลขคู่เป็น off และคี่เป็น on ใช้คำสั่ง pio device monitor เพื่อเตรียมสแกนหา wifi
6. อัพโหลดโปรแกรมเข้าไมโครคอนโทรเลอร์โดยการใช้คำสั่ง pio run-t upload
7. กดปุ่มอัพโหลดและรีเซตที่ตัวไมโทรคอนโทรเลอร์เพื่อให้ตัวโปรแกรมอัพโหลดเข้าไปในตัว microcontroller
8. pio device monitor แล้วดูผลลัพท์
![alt text](https://cdn.discordapp.com/attachments/663373978848591875/824231048232697906/112264361-5c3d2100-8ca3-11eb-8945-d37c9caffd7d.png)
9.  สังเกตหลอดไฟจะมีไฟเปิดและปิด
10. นำ microcontroller ที่เขียนโปรแกรมไว้แล้วมาต่อเข้ากับตัวรีเรย์
11. นำตัวรีเรย์ต่อเข้ากับขั้วชาร์ต(ใช้รีเลย์มาช่วยในการเปิด-ปิดสวิตซ์สามารถนำไปประยุกต์ใช้กับอุปกรณ์ที่ใช้ไฟฟ้าได้ ซึ่งรีเลย์จะทำงานทุกๆครึ่งวินาที)
## การบันทึกผลการทดลอง
หลังจากที่รันคำสั่ง
 pio device monitor จะแสดงผล on-off สลับกับไปทุกๆครึ่งวินาทีและ port 0 จะไฟติดเมื่อ on และหลังจากที่ต่อรีเลย์เพื่อควบคุมการเปิด-ปิดสวิตซ์จะแสดงผล on-off สลับกับไปทุกๆครึ่งวินาทีและไฟติดเมื่อ on
 ## อภิปรายผลการทดลอง
 จากการทดลองนี้จะเห็นว่าเมื่อเราอัพเดตโปรแกรม 03 Output-Port ลงในไมโครคอนโทรลเลอร์และใช้คำสั่ง pio device monitor เพื่อดูการทำงานของไมโครคอนโทรลเลอร์ หน้าจอจะปรากฎ on และ off ทุกๆ 500 ms ตามโค้ดที่เราใส่ลงในโปรแกรมและเมื่อสังเกตหลอดไฟ LED ที่พอร์ต 0 จะสว่างและดับตามคำสั่ง on off ตามโปรแกรมที่เราได้อัปโหลดและเมื่อนำไมโครคอนโทรลเลอร์นี้ไปใช้กับรีเลย์จะเห็นว่ารีเรย์จะเเปิดปิดสวิตช์สอดคล้องกับโค้ดที่เรา ใส่ไว้ในตัวไมโครคอนโทรเลอร์
